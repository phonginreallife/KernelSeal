# Gitleaks configuration for secret detection
# https://github.com/gitleaks/gitleaks

title = "KernelSeal Gitleaks Configuration"

[extend]
# Use the default gitleaks rules as a base
useDefault = true

# Custom rules for this project
[[rules]]
id = "kernelseal-api-key"
description = "KernelSeal API Key"
regex = '''KernelSeal[_-]?API[_-]?KEY\s*[=:]\s*["']?[A-Za-z0-9_-]{16,}["']?'''
tags = ["kernelseal", "api-key"]

[[rules]]
id = "kernelseal-db-password"
description = "KernelSeal Database Password"
regex = '''KernelSeal[_-]?DB[_-]?PASSWORD\s*[=:]\s*["']?[A-Za-z0-9!@#$%^&*()_+-=]{8,}["']?'''
tags = ["kernelseal", "database", "password"]

[[rules]]
id = "vault-token"
description = "HashiCorp Vault Token"
regex = '''(?:hvs\.[a-zA-Z0-9_-]{25,}|s\.[a-zA-Z0-9]{24})'''
tags = ["vault", "token"]

[[rules]]
id = "kubernetes-secret"
description = "Base64 encoded Kubernetes secret data"
regex = '''data:\s*\n\s+\w+:\s+[A-Za-z0-9+/]{40,}={0,2}'''
tags = ["kubernetes", "secret"]

# Allowlist - files and patterns that are OK to have "secrets"
[allowlist]
description = "Global allowlist"
paths = [
  # Test files with fake credentials
  '''.*_test\.go$''',
  # Documentation and examples
  '''README\.md$''',
  '''SECURITY\.md$''',
  '''examples/.*\.yaml$''',
  # Demo files with placeholder secrets
  '''demo/.*''',
  '''scripts/run-demo\.sh$''',
  # Gitleaks config itself
  '''\.gitleaks\.toml$''',
]

# Commits to ignore (if any known false positives)
commits = []

# Specific regex patterns to ignore (placeholders and demo values)
regexes = [
  # Demo/example placeholder values
  '''demo-.*''',
  '''docker-demo-.*''',
  '''placeholder.*''',
  '''my-secret.*''',
  '''secret-value.*''',
  '''file-secret.*''',
  '''super-secret.*''',
  '''example.*''',
  '''changeme''',
  '''CHANGEME''',
  # Test values
  '''test.*password''',
  '''test.*secret''',
  # Generic placeholders
  '''.*-here$''',
  # False positives - Go struct field access patterns
  '''s\.KernelSeal.*''',
  '''Objs\.KernelSeal.*''',
  '''lsmObjs\..*''',
]
