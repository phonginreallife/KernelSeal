# KernelSeal Default Configuration
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: kernelseal-config
  namespace: kernelseal-system
  labels:
    app.kubernetes.io/name: kernelseal
data:
  config.yaml: |
    # KernelSeal Configuration
    # See documentation for all available options
    
    version: v1
    
    # Policy settings - how KernelSeal enforces secret protection
    policy:
      # Mode: disabled, audit (log only), enforce (block and log)
      mode: enforce
      
      # Block read access to /proc/<pid>/environ for protected processes
      blockEnviron: true
      
      # Block read access to /proc/<pid>/mem for protected processes
      blockMem: true
      
      # Block read access to /proc/<pid>/maps for protected processes
      blockMaps: false
      
      # Block ptrace attach to protected processes
      blockPtrace: true
      
      # Allow a process to read its own /proc files
      allowSelfRead: true
      
      # Audit all accesses to protected resources (even if allowed)
      auditAll: false
    
    # Secret bindings - define which secrets go to which processes
    # Secrets are injected when a matching process starts
    secrets: []
    # Example:
    # - name: web-app-secrets
    #   selector:
    #     binary: "nginx"      # Match by binary name
    #     # container: "web"   # Match by container name  
    #     # labels:            # Match by pod labels
    #     #   app: web
    #     # namespace: production
    #   secretRefs:
    #     - name: SSL_CERT_PASSWORD
    #       source:
    #         secretKeyRef:
    #           name: ssl-certs
    #           key: password
    
    # Monitoring configuration
    monitoring:
      enabled: true
      metricsPort: 9090
      logLevel: info
      auditLog: /var/log/kernelseal/audit.log
